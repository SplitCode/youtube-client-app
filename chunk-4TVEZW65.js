import{a as v}from"./chunk-4NDBE4LN.js";import{m as g,s as w,t as S}from"./chunk-WRO4K3SO.js";import{a as h,b as C}from"./chunk-USKRQM6E.js";import{Z as u,a as l,b as $,ea as d,ja as m,k as c,ka as f,v as p}from"./chunk-H4LMUWBJ.js";var x=(()=>{let e=class e{constructor(t){this.store=t,this.filterWord$$=new c(""),this.cardsList$$=new c([]),this.isDateSortClick$$=new c(!1),this.isViewSortClick$$=new c(!1),this.currentFilterWord$=this.filterWord$$.asObservable(),this.currentCardList$=this.cardsList$$.asObservable(),this.store.select(v).subscribe(s=>{this.cardsList$$.next(s)})}updateFilterWord(t){this.filterWord$$.next(t)}updateDateSortClick(){this.isDateSortClick$$.next(!this.isDateSortClick$$.getValue()),this.sortCardsByDate()}updateViewSortClick(){this.isViewSortClick$$.next(!this.isViewSortClick$$.getValue()),this.sortCardsByViews()}searchCards(t){console.log("Search query:",t),t.trim()===""?(this.cardsList$$.next([]),this.store.dispatch(S({cards:[]}))):this.store.dispatch(w({query:t.trim()}))}sortCardsByDate(){let t=[...this.cardsList$$.getValue()];console.log("Cards for sort",t);let s=this.isDateSortClick$$.getValue();t.sort((r,i)=>{let a=new Date("snippet"in r?r.snippet.publishedAt:r.date).getTime(),n=new Date("snippet"in i?i.snippet.publishedAt:i.date).getTime();return s?a-n:n-a}),console.log(t),this.cardsList$$.next(t)}sortCardsByViews(){let t=[...this.cardsList$$.getValue()],s=this.isViewSortClick$$.getValue();t.sort((r,i)=>{let a="statistics"in r?parseInt(r.statistics?.viewCount||"0",10):0,n="statistics"in i?parseInt(i.statistics?.viewCount||"0",10):0;return s?a-n:n-a}),this.cardsList$$.next(t)}};e.\u0275fac=function(s){return new(s||e)(m(g))},e.\u0275prov=d({token:e,factory:e.\u0275fac,providedIn:"root"});let o=e;return o})();var W=(()=>{let e=class e{constructor(){this.http=f(C)}getCardsData(t){let s="/api/search",r=new h().set("type","video").set("part","snippet").set("maxResults","20").set("q",t);return this.http.get(s,{params:r}).pipe(p(i=>i.items))}getStatistics(t){let s="/api/videos",r=new h().set("id",t).set("part","snippet,statistics");return this.http.get(s,{params:r}).pipe(p(i=>i.items))}getCardsDataWithStatistics(t){return this.getCardsData(t).pipe(u(s=>{let r=s.map(i=>i.id.videoId).join(",");return this.getStatistics(r).pipe(p(i=>s.map(a=>$(l({},a),{statistics:i.find(n=>n.id===a.id.videoId)?.statistics}))))}))}getCardById(t){let s="/api/videos",r=new h().set("id",t).set("part","snippet,statistics");return this.http.get(s,{params:r}).pipe(p(i=>i.items[0]))}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=d({token:e,factory:e.\u0275fac,providedIn:"root"});let o=e;return o})();export{x as a,W as b};
