import{a as $,b as f}from"./chunk-GNBJRYWW.js";import{M as m,S as d,Y as h,a as l,b as u,k as n,r as p}from"./chunk-L5TMY7ZW.js";var w=(()=>{let i=class i{constructor(){this.http=h(f)}getStatistics(t){let s="/api/videos",r=new $().set("id",t).set("part","snippet,statistics");return this.http.get(s,{params:r}).pipe(p(e=>e.items))}getCardsDataWithStatistics(t){return this.getCardsData(t).pipe(m(s=>{let r=s.map(e=>e.id.videoId).join(",");return this.getStatistics(r).pipe(p(e=>s.map(a=>u(l({},a),{statistics:e.find(o=>o.id===a.id.videoId)?.statistics}))))}))}getCardById(t){let s="/api/videos",r=new $().set("id",t).set("part","snippet,statistics");return this.http.get(s,{params:r}).pipe(p(e=>e.items[0]))}getCardsData(t){let s="/api/search",r=new $().set("type","video").set("part","snippet").set("maxResults","15").set("q",t);return this.http.get(s,{params:r}).pipe(p(e=>e.items))}};i.\u0275fac=function(s){return new(s||i)},i.\u0275prov=d({token:i,factory:i.\u0275fac,providedIn:"root"});let c=i;return c})();var L=(()=>{let i=class i{constructor(){this.searchQuery$$=new n(""),this.filterWord$$=new n(""),this.cardsList$$=new n([]),this.isDateSortClick$$=new n(!1),this.isViewSortClick$$=new n(!1),this.currentSearchQuery$=this.searchQuery$$.asObservable(),this.currentFilterWord$=this.filterWord$$.asObservable(),this.currentCardList$=this.cardsList$$.asObservable(),this.cardDataService=h(w)}updateFilterWord(t){this.filterWord$$.next(t)}updateDateSortClick(){this.isDateSortClick$$.next(!this.isDateSortClick$$.getValue()),this.sortCardsByDate()}updateViewSortClick(){this.isViewSortClick$$.next(!this.isViewSortClick$$.getValue()),this.sortCardsByViews()}searchCards(t){t.trim()===""?this.cardsList$$.next([]):this.cardDataService.getCardsDataWithStatistics(t).subscribe(s=>{this.cardsList$$.next(s)})}sortCardsByDate(){let t=this.cardsList$$.getValue(),s=this.isDateSortClick$$.getValue();t.sort((r,e)=>{let a=new Date(r.snippet.publishedAt).getTime(),o=new Date(e.snippet.publishedAt).getTime();return s?a-o:o-a}),this.cardsList$$.next(t)}sortCardsByViews(){let t=this.cardsList$$.getValue(),s=this.isViewSortClick$$.getValue();t=t.sort((r,e)=>{let a=parseInt(r.statistics?.viewCount||"0",10),o=parseInt(e.statistics?.viewCount||"0",10);return s?a-o:o-a}),this.cardsList$$.next(t)}};i.\u0275fac=function(s){return new(s||i)},i.\u0275prov=d({token:i,factory:i.\u0275fac,providedIn:"root"});let c=i;return c})();export{w as a,L as b};
