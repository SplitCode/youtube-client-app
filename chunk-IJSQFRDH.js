import{a as $,b as f}from"./chunk-NGRIG6IZ.js";import{M as m,S as d,Y as h,a as l,b as u,k as n,r as p}from"./chunk-STXYDF7G.js";var w=(()=>{let e=class e{constructor(){this.http=h(f)}getCardsData(t){let s="/api/search",r=new $().set("type","video").set("part","snippet").set("maxResults","15").set("q",t);return this.http.get(s,{params:r}).pipe(p(i=>i.items))}getStatistics(t){let s="/api/videos",r=new $().set("id",t).set("part","snippet,statistics");return this.http.get(s,{params:r}).pipe(p(i=>i.items))}getCardsDataWithStatistics(t){return this.getCardsData(t).pipe(m(s=>{let r=s.map(i=>i.id.videoId).join(",");return this.getStatistics(r).pipe(p(i=>s.map(a=>u(l({},a),{statistics:i.find(o=>o.id===a.id.videoId)?.statistics}))))}))}getCardById(t){let s="/api/videos",r=new $().set("id",t).set("part","snippet,statistics");return this.http.get(s,{params:r}).pipe(p(i=>i.items[0]))}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=d({token:e,factory:e.\u0275fac,providedIn:"root"});let c=e;return c})();var L=(()=>{let e=class e{constructor(){this.searchQuery$$=new n(""),this.filterWord$$=new n(""),this.cardsList$$=new n([]),this.isDateSortClick$$=new n(!1),this.isViewSortClick$$=new n(!1),this.currentSearchQuery$=this.searchQuery$$.asObservable(),this.currentFilterWord$=this.filterWord$$.asObservable(),this.currentCardList$=this.cardsList$$.asObservable(),this.cardDataService=h(w)}updateSearchQuery(t){this.searchQuery$$.next(t),this.searchCards(t)}updateFilterWord(t){this.filterWord$$.next(t)}updateDateSortClick(){this.isDateSortClick$$.next(!this.isDateSortClick$$.getValue()),this.sortCardsByDate()}updateViewSortClick(){this.isViewSortClick$$.next(!this.isViewSortClick$$.getValue()),this.sortCardsByViews()}searchCards(t){t.trim()===""?this.cardsList$$.next([]):this.cardDataService.getCardsDataWithStatistics(t).subscribe(s=>{this.cardsList$$.next(s)})}sortCardsByDate(){let t=this.cardsList$$.getValue(),s=this.isDateSortClick$$.getValue();t.sort((r,i)=>{let a=new Date(r.snippet.publishedAt).getTime(),o=new Date(i.snippet.publishedAt).getTime();return s?a-o:o-a}),this.cardsList$$.next(t)}sortCardsByViews(){let t=this.cardsList$$.getValue(),s=this.isViewSortClick$$.getValue();t=t.sort((r,i)=>{let a=parseInt(r.statistics?.viewCount||"0",10),o=parseInt(i.statistics?.viewCount||"0",10);return s?a-o:o-a}),this.cardsList$$.next(t)}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=d({token:e,factory:e.\u0275fac,providedIn:"root"});let c=e;return c})();export{w as a,L as b};
