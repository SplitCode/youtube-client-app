import{m as S,n as h,o as v,s as b,t as x}from"./chunk-BFORNM46.js";import{a as l,b as w}from"./chunk-UON7Z75M.js";import{Z as C,a as $,b as m,ea as p,ja as f,k as n,ka as g,v as d}from"./chunk-L7A6ZB56.js";var u=v("cardState"),V=h(u,i=>i.cards),I=h(u,i=>i.customCards),y=h(u,i=>[...i.customCards,...i.cards]);var F=(()=>{let e=class e{constructor(t){this.store=t,this.filterWord$$=new n(""),this.cardsList$$=new n([]),this.isDateSortClick$$=new n(!1),this.isViewSortClick$$=new n(!1),this.currentFilterWord$=this.filterWord$$.asObservable(),this.currentCardList$=this.cardsList$$.asObservable(),this.store.select(V).subscribe(s=>{this.cardsList$$.next(s)})}updateFilterWord(t){this.filterWord$$.next(t)}updateDateSortClick(){this.isDateSortClick$$.next(!this.isDateSortClick$$.getValue()),this.sortCardsByDate()}updateViewSortClick(){this.isViewSortClick$$.next(!this.isViewSortClick$$.getValue()),this.sortCardsByViews()}searchCards(t){console.log("Search query:",t),t.trim()===""?(this.cardsList$$.next([]),this.store.dispatch(x({cards:[],nextPageToken:""}))):this.store.dispatch(b({query:t.trim()}))}sortCardsByDate(){let t=[...this.cardsList$$.getValue()];console.log("Cards for sort",t);let s=this.isDateSortClick$$.getValue();t.sort((a,r)=>{let o=new Date(a.snippet.publishedAt).getTime(),c=new Date(r.snippet.publishedAt).getTime();return s?o-c:c-o}),console.log(t),this.cardsList$$.next(t)}sortCardsByViews(){let t=[...this.cardsList$$.getValue()],s=this.isViewSortClick$$.getValue();t.sort((a,r)=>{let o=parseInt(a.statistics?.viewCount||"0",10),c=parseInt(r.statistics?.viewCount||"0",10);return s?o-c:c-o}),this.cardsList$$.next(t)}};e.\u0275fac=function(s){return new(s||e)(f(S))},e.\u0275prov=p({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var M=(()=>{let e=class e{constructor(){this.http=g(w)}getCardsData(t){let s="/api/search",a=new l().set("type","video").set("part","snippet").set("maxResults","20").set("q",t);return this.http.get(s,{params:a}).pipe(d(r=>r.items))}getStatistics(t){let s="/api/videos",a=new l().set("id",t).set("part","snippet,statistics");return this.http.get(s,{params:a}).pipe(d(r=>r.items))}getCardsDataWithStatistics(t){return this.getCardsData(t).pipe(C(s=>{let a=s.map(r=>r.id.videoId).join(",");return this.getStatistics(a).pipe(d(r=>s.map(o=>m($({},o),{statistics:r.find(c=>c.id===o.id.videoId)?.statistics}))))}))}getCardById(t){let s="/api/videos",a=new l().set("id",t).set("part","snippet,statistics");return this.http.get(s,{params:a}).pipe(d(r=>r.items[0]))}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=p({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();export{F as a,M as b};
